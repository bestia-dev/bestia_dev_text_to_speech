<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="bestia_dev_text_to_speech"><meta name="keywords" content="rust, rustlang, rust-lang, bestia_dev_text_to_speech"><title>bestia_dev_text_to_speech - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a class="sidebar-logo" href="../bestia_dev_text_to_speech/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.png" alt="logo"></div>
        </a><h2 class="location">Crate bestia_dev_text_to_speech</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.1.30</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all bestia_dev_text_to_speech's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#functions">Functions</a></li></ul></div><div id="sidebar-vars" data-name="bestia_dev_text_to_speech" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../bestia_dev_text_to_speech/index.html"><img class="rust-logo" src="../rust-logo.png" alt="logo"></a><nav class="sub"><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">bestia_dev_text_to_speech</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/bestia_dev_text_to_speech/lib.rs.html#4-179" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="bestia_dev_text_to_speech" class="section-header"><a href="#bestia_dev_text_to_speech">bestia_dev_text_to_speech</a></h2>
<p><strong>Text-to-speech CLI using Google api</strong><br />
<em><strong>version: 0.1.30 date: 2022-04-08 author: <a href="bestia.dev">bestia.dev</a> repository: <a href="https://github.com/bestia-dev/bestia_dev_text_to_speech">Github</a></strong></em></p>
<p><a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://img.shields.io/badge/Lines_in_Rust-63-green.svg" alt="Lines in Rust code" /></a>
<a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://img.shields.io/badge/Lines_in_Doc_comments-165-blue.svg" alt="Lines in Doc comments" /></a>
<a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://img.shields.io/badge/Lines_in_comments-18-purple.svg" alt="Lines in Comments" /></a>
<a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://img.shields.io/badge/Lines_in_examples-15-yellow.svg" alt="Lines in examples" /></a>
<a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://img.shields.io/badge/Lines_in_tests-20-orange.svg" alt="Lines in tests" /></a></p>
<p><a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/blob/main/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="Licence" /></a> <a href="https://github.com/bestia-dev/bestia_dev_text_to_speech/"><img src="https://github.com/bestia-dev/bestia_dev_text_to_speech/workflows/RustAction/badge.svg" alt="Rust" /></a></p>
<h3 id="motivation" class="section-header"><a href="#motivation">Motivation</a></h3>
<p>After creating some interesting projects and tutorials for rust development and sharing them on Github, I wanted to create youtube videos for them. Sometimes it is easier to follow a video tutorial then to read kilometers of text tutorials.<br />
The easy part is capturing the screen with <code>OBS Studio</code>. Everything visual is going on on the screen. It is a computer project, after all. The hard part is the spoken text.<br />
It is impossible to just naturally talk about what I am doing while recording the screen. Maybe somebody has the talent of fast and focused speech. I don’t. Maybe because I am not a native English speaker. I am not at home as a speaker.<br />
And my voice sound terrible and the accent and intonation is just not what english should sound like.
But I can write pretty well. It takes ages and it is very slow, but I am happy with the result.<br />
I am a programmer and for me every problem has a software solution. This is the story when you have a hammer, everything looks like a nail.</p>
<p>Finally I decided to use a text-to-speech approach.</p>
<p>I have a (very cheap) google account that I use for a VM that hosts my domain and my website. Google is very kind to offer text-to-speech api for free for 1 million characters. I hope this could be the right solution for me. It sounds very natural. It uses some magic neural network and it sounds definitely better then me.<br />
But it is only an api. There is no prepared application or website that I can use.</p>
<p>What is more fun, than write an application in Rust for my problem?</p>
<h3 id="rust-cli-from-template" class="section-header"><a href="#rust-cli-from-template">Rust CLI from template</a></h3>
<p>The easiest application to write in Rust is a CLI in Linux. And honestly I don’t need more. I will have a text file as input and an mp3 file as output. Perfect for a CLI application.
For the first time I will develope a new Rust application entirely inside a docker container using my project <a href="https://github.com/bestia-dev/docker_rust_development">https://github.com/bestia-dev/docker_rust_development</a>. I want to have my rust development sandboxed. I am scared to allow tools and crates from unknown developers to have full access to my underlying system: Win10+WSL2 (<a href="https://github.com/bestia-dev/win10_wsl2_debian11">https://github.com/bestia-dev/win10_wsl2_debian11</a>).<br />
In <code>WSL2 terminal</code>:</p>
<div class="example-wrap"><pre class="language-bash"><code>cd rustprojects/docker_rust_development/
sh rust_dev_pod_after_reboot.sh</code></pre></div>
<p>In VSCode: <code>F1</code>, type <code>ssh</code>, choose <code>Remote-SSH:Connect to Host...</code>, choose <code>rust_dev_pod</code>, type the passphrase for the SSH key. We have opened a new VSCode window that works inside the Rust development container.</p>
<p>I will also use for the first time my template for Rust CLI development: <a href="https://github.com/bestia-dev/bestia_dev_cargo_auto_new_cli">https://github.com/bestia-dev/bestia_dev_cargo_auto_new_cli</a>. It separates a lib and a bin, so the project could be used as a library for other projects. It has prepared automation tasks for building the project and some samples how to use tests and examples.<br />
In <code>VSCode terminal</code>:</p>
<div class="example-wrap"><pre class="language-bash"><code>eval $(ssh-agent)
ssh-add /home/rustdevuser/.ssh/githubssh1
mkdir ~/rustprojects
cd ~/rustprojects
git clone git@github.com:bestia-dev/bestia_dev_cargo_auto_new_cli.git
mv bestia_dev_cargo_auto_new_cli bestia_dev_text_to_speech
cd bestia_dev_text_to_speech
rm -r -f .git
rm -r docs
mv src/bin/bestia_dev_cargo_auto_new_cli.rs src/bin/bestia_dev_text_to_speech.rs
code .
</code></pre></div><h3 id="template-renaming" class="section-header"><a href="#template-renaming">Template Renaming</a></h3>
<ol>
<li>In Cargo.toml change the name and the description and some other info.</li>
<li>In <code>VSCode terminal</code> type <code>cargo auto release</code> to copy the title and description to README.md and lib.rs.</li>
<li>Replace the title in other files. In VSCode Ctrl+Shift+H to open the replace in all files. Search for <code>bestia_dev_cargo_auto_new_cli</code>, replace with <code>bestia_dev_text_to_speech</code>. When you click on the result list item, you can see what you are actually replacing. A small icon at the right end of the item is <code>Replace (Ctrl+Shift+1)</code>.</li>
</ol>
<p>For now I will leave the functions that are used in examples and tests. I will modify them, when the new functions will be ready.</p>
<h3 id="github-push-new-project" class="section-header"><a href="#github-push-new-project">Github push new project</a></h3>
<p>First in VSCode open Source Control (Ctrl+Shift+G), click <code>Initialize Repository</code>, type the message <code>init</code> and Ctrl+Enter.
On the Github website create a new project <a href="https://github.com/new">https://github.com/new</a>, copy the name and the description from Cargo.toml. You don’t need other files magically created. Save the new project. Github is very kind to give us some Git commands we can use. Now in <code>VSCode terminal</code> copy the commands from Github (second group):</p>
<div class="example-wrap"><pre class="language-bash"><code>git remote add origin git@github.com:bestia-dev/bestia_dev_text_to_speech.git
git branch -M main
git push -u origin main</code></pre></div><h3 id="readmemd" class="section-header"><a href="#readmemd">README.md</a></h3>
<p>Open <code>README.md</code> and delete the text you don’t need. Don’t delete the markers for the automation. You can see the markdown preview with (Ctrl+k, v). Save the changes.
Commit the changes and push in <code>VSCode terminal</code>: <code>cargo auto commit_and_push &quot;readme cleaned&quot;</code>
Commit and push often to reduce the risk of loosing your work.</p>
<h3 id="google-api-text-to-speech" class="section-header"><a href="#google-api-text-to-speech">google api text-to-speech</a></h3>
<p>In my googlecloud account I enabled the text-to-speech api: <a href="https://console.cloud.google.com/apis/api/texttospeech.googleapis.com">https://console.cloud.google.com/apis/api/texttospeech.googleapis.com</a><br />
Service name <code>texttospeech.googleapis.com</code><br />
I need some credentials to access the api: <a href="https://console.cloud.google.com/apis/credentials">https://console.cloud.google.com/apis/credentials</a>
Click <code>+Create credentials</code>, <code>API key</code>, then <code>edit</code>, rename to <code>API text-to-speech</code>, restrict to only <code>Cloud Text-to-Speech API</code>.
Use this key in your application by passing it with the <code>?key=API_KEY</code> parameter for every request.
Save this api key in env variable:</p>
<div class="example-wrap"><pre class="language-bash"><code> export bestia_dev_text_to_speech_api_key=YOUR_API_KEY
env
echo $bestia_dev_text_to_speech_api_key
unset bestia_dev_text_to_speech_api_key</code></pre></div>
<p>The simplest example from google:</p>
<div class="example-wrap"><pre class="language-bash"><code>curl -X POST \
-H &quot;Content-Type: application/json; charset=utf-8&quot; \
-d @sample_files/request.json \
&quot;https://texttospeech.googleapis.com/v1/text:synthesize?key=$bestia_dev_text_to_speech_api_key&quot;</code></pre></div>
<p>Because of https only the domain part of the url <code>texttospeech.googleapis.com</code> is visible on the wire. The rest of the url <code>/v1/text:synthesize?key=$bestia_dev_text_to_speech_api_key</code> is encrypted. So it looks that the api-key is secure. They are encrypted on the wire (in transport) but if either end (user or server) logs the URL to a plain text file and does not sanitize credentials… now that’s a different conversation. Browsers can save the entire url in history, but I am not using a browser.</p>
<h3 id="https-client" class="section-header"><a href="#https-client">https client</a></h3>
<p>Among crates curl-rust, hyper, reqwest, Isahc, Surf and ureq, I choose ureq. It is minimal.</p>
<h3 id="cargo-crev-reviews-and-advisory" class="section-header"><a href="#cargo-crev-reviews-and-advisory">cargo crev reviews and advisory</a></h3>
<p>We live in times of danger with <a href="https://en.wikipedia.org/wiki/Supply_chain_attack">supply chain attacks</a>.</p>
<p>It is recommended to always use <a href="https://github.com/crev-dev/cargo-crev">cargo-crev</a> to verify the trustworthiness of each of your dependencies.</p>
<p>Please, spread this info.</p>
<p>You can also read crev reviews quickly on the web:</p>
<p><a href="https://web.crev.dev/rust-reviews/crates/">https://web.crev.dev/rust-reviews/crates/</a></p>
<h3 id="open-source-and-free-as-a-beer" class="section-header"><a href="#open-source-and-free-as-a-beer">open-source and free as a beer</a></h3>
<p>My open-source projects are free as a beer (MIT license).</p>
<p>I just love programming.</p>
<p>But I need also to drink. If you find my projects and tutorials helpful,please buy me a beer donating on my <a href="https://paypal.me/LucianoBestia">paypal</a>.</p>
<p>You know the price of a beer in your local bar ;-) So I can drink a free beer for your health :-)</p>
<p><a href="https://translate.google.com/?hl=en&amp;sl=sl&amp;tl=en&amp;text=Na%20zdravje&amp;op=translate">Na zdravje!</a> <a href="https://dictionary.cambridge.org/dictionary/italian-english/alla-salute">Alla salute!</a> <a href="https://dictionary.cambridge.org/dictionary/german-english/prost">Prost!</a> <a href="https://matadornetwork.com/nights/how-to-say-cheers-in-50-languages/">Nazdravlje!</a> 🍻</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="utils_mod/index.html" title="bestia_dev_text_to_speech::utils_mod mod">utils_mod</a></div><div class="item-right docblock-short"><p>Just an example how to create and call a module in a separate file.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.format_hello_phrase.html" title="bestia_dev_text_to_speech::format_hello_phrase fn">format_hello_phrase</a></div><div class="item-right docblock-short"><p>format the hello phrase</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.format_upper.html" title="bestia_dev_text_to_speech::format_upper fn">format_upper</a></div><div class="item-right docblock-short"><p>format the hello phrase with uppercase name</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.post_text_to_speech.html" title="bestia_dev_text_to_speech::post_text_to_speech fn">post_text_to_speech</a></div><div class="item-right docblock-short"></div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="bestia_dev_text_to_speech" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.59.0 (9d1b2106e 2022-02-23)" ></div>
</body></html>